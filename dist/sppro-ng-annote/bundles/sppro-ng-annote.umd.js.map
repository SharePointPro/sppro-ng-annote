{"version":3,"file":"sppro-ng-annote.umd.js","sources":["../../../projects/sppro-ng-annote/src/lib/enums/drawableEnum.ts","../../../projects/sppro-ng-annote/src/lib/factories/shapeFactory.ts","../../../projects/sppro-ng-annote/src/lib/factories/textareaFactory.ts","../../../projects/sppro-ng-annote/src/lib/ng-annote/ng-annote.component.ts","../../../projects/sppro-ng-annote/src/lib/toolbar/toolbar.component.ts","../../../projects/sppro-ng-annote/src/lib/sppro-ng-annote.module.ts","../../../projects/sppro-ng-annote/src/public-api.ts","../../../projects/sppro-ng-annote/src/sppro-ng-annote.ts"],"sourcesContent":["export enum DrawableEnum {\r\n    FreePathDrawable,\r\n    SquareDrawable,\r\n    CircleDrawable,\r\n    ArrowDrawable,\r\n    TextDrawable\r\n  }","import { normalizeGenFileSuffix } from '@angular/compiler/src/aot/util';\r\nimport Konva from 'konva';\r\n\r\nconst TEXT_AREA_ID = \"konva-text-editor\";\r\n\r\nexport default {\r\n    CreateLine(x: number, y: number, color: string): Konva.Line {\r\n        return new Konva.Line({\r\n            stroke: color,\r\n            strokeWidth: 2,\r\n            // globalCompositeOperation:\r\n            //   this.mode === 'brush' ? 'source-over' : 'destination-out',\r\n            points: [x, y],\r\n            draggable: true\r\n        });\r\n    },\r\n    CreateRectange(x: number, y: number, color: string): Konva.Rect {\r\n        return new Konva.Rect({\r\n            stroke: color,\r\n            strokeWidth: 2,\r\n            x: x,\r\n            y: y,\r\n            width: 0,\r\n            height: 0,\r\n            draggable: true\r\n        });\r\n    },\r\n    CreateCircle(x: number, y: number, color: string): Konva.Circle {\r\n        return new Konva.Circle({\r\n            stroke: color,\r\n            strokeWidth: 2,\r\n            x: x,\r\n            y: y,\r\n            radius: 0,\r\n            draggable: true\r\n        });\r\n    },\r\n    CreateArrow(x: number, y: number, color: string): Konva.Arrow {\r\n        return new Konva.Arrow({\r\n            stroke: color,\r\n            strokeWidth: 2,\r\n            points: [x, y],\r\n            draggable: true\r\n        });\r\n    },\r\n    CreateText(x: number, y: number, color: string, fontFamily: string, text: string): Konva.Text {\r\n        return new Konva.Text({\r\n            stroke: color,\r\n            strokeWidth: .1,\r\n            x: x,\r\n            y: y + 1,\r\n            text: text,\r\n            draggable: true,\r\n            fontFamily: fontFamily,\r\n            fontStyle: 'normal'\r\n        });\r\n    }\r\n\r\n}\r\n","const TEXT_AREA_ID = \"konva-text-editor\";\r\n\r\nexport default {\r\n    createTextArea: (x: number, y: number, color: string, fontFamily: string, onBlur: Function) => {\r\n        let textarea = getTextArea();\r\n        styleTextarea(textarea, x, y, color, fontFamily);\r\n        setupEvents(textarea, onBlur);\r\n\r\n        //Auto focus after creation\r\n        setTimeout(() => {\r\n            textarea.focus();\r\n        }, (100));\r\n    }\r\n}\r\n\r\nconst getTextArea = () => {\r\n    var textarea = document.getElementById(TEXT_AREA_ID);\r\n    if (!textarea) {\r\n        textarea = document.createElement('textarea');\r\n        let canvas = document.getElementsByClassName(\"konvajs-content\")[0];\r\n        canvas.appendChild(textarea);\r\n\r\n        textarea.style.position = 'absolute';\r\n        textarea.id = TEXT_AREA_ID;\r\n    }\r\n    return textarea;\r\n}\r\n\r\nconst styleTextarea = (textarea, x, y, color, fontFamily) => {\r\n    textarea.style.top = y + 'px';\r\n    textarea.style.left = x + 'px';\r\n    textarea.style.width = \"20px\";\r\n    textarea.style.height = \"20px\"\r\n    textarea.style.fontSize = '12px';\r\n    textarea.style.border = 'none';\r\n    textarea.style.padding = '0px';\r\n    textarea.style.margin = '0px';\r\n    textarea.style.overflow = 'hidden';\r\n    textarea.style.whiteSpace = 'nowrap';\r\n    textarea.style.background = 'none';\r\n    textarea.style.outline = 'none';\r\n    textarea.style.resize = 'none';\r\n    textarea.style.lineHeight = \"12px\"\r\n    textarea.style.transformOrigin = 'left top';\r\n    textarea.style.color = color;\r\n    textarea.style.fontFamily = fontFamily;\r\n}\r\n\r\nconst setupEvents = (textarea, onBlur) => {\r\n \r\n    textarea.addEventListener('input', (e) => {\r\n        autoExpand(e.target);\r\n    });\r\n\r\n    textarea.addEventListener('blur', (e) => {\r\n        removeTextarea();\r\n        onBlur(e);\r\n    });\r\n}\r\n\r\nconst removeTextarea = () => {\r\n    var elem = document.getElementById(TEXT_AREA_ID);\r\n    if (elem != null) {\r\n        elem.parentNode.removeChild(elem);\r\n    }\r\n}\r\n\r\nconst autoExpand = (field) => {\r\n    // Calculate the height\r\n    var height = field.scrollHeight;\r\n    var width = field.scrollWidth;\r\n    field.style.width = width + 'px';\r\n    field.style.height = height + 'px';\r\n}","import { createOfflineCompileUrlResolver } from '@angular/compiler';\nimport { Component, EventEmitter, OnInit, Output } from '@angular/core';\nimport Konva from 'konva';\nimport { DrawableEnum } from  '../enums/drawableEnum';\nimport shapeFactory from '../factories/shapeFactory';\nimport textareaFactory from '../factories/textareaFactory';\n\nconst DEFAULT_DRAWABLE_TYPE: DrawableEnum = DrawableEnum.FreePathDrawable;\nconst DEFAULT_FONT_FAMILY: string = 'Arial';\n\n@Component({\n  selector: 'sppro-ng-annote',\n  templateUrl: './ng-annote.component.html',\n  styleUrls: ['./ng-annote.component.scss']\n})\nexport class NgAnnoteComponent implements OnInit {\n\n  @Output() onSave = new EventEmitter<string>();\n\n  private _drawableType: DrawableEnum = DEFAULT_DRAWABLE_TYPE;\n\n  stage: Konva.Stage;\n  layer: Konva.Layer;\n  image: Konva.Image;\n  isPaint: boolean = false;\n  mode: string = 'brush';\n  lastShape: any;\n  color: string = '#000000';\n  textAreaVisible: boolean = false;\n\n\n  img: HTMLImageElement;\n\n  constructor() {\n\n  }\n\n\n  get drawableType(): DrawableEnum {\n    return this._drawableType;\n  }\n\n  set drawableType(value: DrawableEnum) {\n    this._drawableType = value;\n  }\n\n  ngOnInit(): void {\n    this.img = new Image();\n\n    this.img.onload = () => {\n\n      this.image = new Konva.Image({\n        image: this.img,\n      });\n\n      this.initalizeStage();\n\n      this.layer = new Konva.Layer({\n      });\n      this.layer.add(this.image);\n      this.stage.add(this.layer);\n\n    };\n\n    this.img.src = \"https://sharepointpro.github.io/sppro-image-annote/static/media/room.fdc5a868.jpg\";\n  }\n\n\n  initalizeStage(): void {\n    this.stage = new Konva.Stage({\n      container: \"stage\",\n      width: this.img.width,\n      height: this.img.height\n    });\n\n    this.stage.on('mousedown', (e) => { this.onMouseDown(e) });\n    this.stage.on('mouseup', (e) => { this.onMouseUp(e) });\n    this.stage.on('mousemove', (e) => { this.onMouseMove(e) });\n  }\n\n  onMouseDown(e): void {\n    this.isPaint = true;\n\n    var pos = this.stage.getPointerPosition();\n\n    if (this.drawableType === DrawableEnum.FreePathDrawable) {\n      this.lastShape = shapeFactory.CreateLine(pos.x, pos.y, this.color);\n      this.layer.add(this.lastShape);\n    }\n\n    if (this.drawableType === DrawableEnum.SquareDrawable) {\n      this.lastShape = shapeFactory.CreateRectange(pos.x, pos.y, this.color);\n      this.layer.add(this.lastShape);\n    }\n\n    if (this.drawableType === DrawableEnum.CircleDrawable) {\n      this.lastShape = shapeFactory.CreateCircle(pos.x, pos.y, this.color);\n      this.layer.add(this.lastShape);\n    }\n\n    if (this.drawableType === DrawableEnum.ArrowDrawable) {\n      this.lastShape = shapeFactory.CreateArrow(pos.x, pos.y, this.color);\n      this.layer.add(this.lastShape);\n    }\n\n    if (this.drawableType === DrawableEnum.TextDrawable) {\n\n      if (!this.textAreaVisible) {\n        this.textAreaVisible = true;\n\n        textareaFactory.createTextArea(pos.x, pos.y, this.color, DEFAULT_FONT_FAMILY, (element) => {\n          if (element.target.value !== \"\") {\n            this.lastShape = shapeFactory.CreateText(pos.x, pos.y, this.color, DEFAULT_FONT_FAMILY, element.target.value);\n            this.layer.add(this.lastShape);\n            this.layer.batchDraw();\n            this.textAreaVisible = false;\n\n          }\n        })\n      }\n\n    }\n\n  }\n\n  onSaveClick(): void {\n    this.onSave.emit(this.stage.toDataURL());\n  }\n\n  onClear(): void {\n    while (this.layer.children.length > 1){\n      this.onUndo();\n    }\n    this.layer.batchDraw();\n  }\n\n  onMouseUp(e): void {\n    this.isPaint = false;\n    this.lastShape = null;\n  }\n\n  onUndo(): void {\n    if (this.layer.children.length > 1) {\n      this.layer.children.splice(-1, 1);\n      this.layer.batchDraw();\n    }\n  }\n\n  onMouseMove(e): void {\n    if (!this.isPaint || !this.lastShape || this.lastShape === DrawableEnum.TextDrawable) {\n      return;\n    }\n    const pos = this.stage.getPointerPosition();\n\n    if (this.drawableType === DrawableEnum.FreePathDrawable) {\n      let newPoints = this.lastShape.points().concat([pos.x, pos.y]);\n      this.lastShape.points(newPoints);\n    }\n\n    if (this.drawableType === DrawableEnum.SquareDrawable) {\n      const dx = -(this.lastShape.attrs.x - pos.x);\n      const dy = -(this.lastShape.attrs.y - pos.y);\n\n      this.lastShape.attrs.width = dx;\n      this.lastShape.attrs.height = dy;\n    }\n\n    if (this.drawableType === DrawableEnum.CircleDrawable) {\n      const dx = this.lastShape.attrs.x - pos.x;\n      const dy = this.lastShape.attrs.y - pos.y;\n      const radius = Math.sqrt(dx * dx + dy * dy);\n      this.lastShape.attrs.radius = radius;\n    }\n\n    if (this.drawableType === DrawableEnum.ArrowDrawable) {\n      let newPoints = [this.lastShape.attrs.points[0], this.lastShape.attrs.points[1]];\n\n      newPoints.push(pos.x);\n      newPoints.push(pos.y);\n\n      this.lastShape.points(newPoints);\n    }\n\n    this.layer.batchDraw();\n  }\n\n\n}\n","import { Component, EventEmitter, Input, OnInit, Output } from '@angular/core';\nimport { faSave, faBan, faUndo, faSquareFull, faPencilAlt, faSquare, faCircle, faLongArrowAltRight, faFont  } from '@fortawesome/free-solid-svg-icons'\nimport { DrawableEnum } from '../enums/drawableEnum';\n\n@Component({\n  selector: 'sppro-toolbar',\n  templateUrl: './toolbar.component.html',\n  styleUrls: ['./toolbar.component.scss']\n})\nexport class ToolbarComponent implements OnInit {\n\n  @Output() drawableTypeChange = new EventEmitter<DrawableEnum>();\n  @Input() drawableType:DrawableEnum;\n\n  @Output() colorChange = new EventEmitter<string>();\n  @Input() color:string;\n\n  @Output() onUndo = new EventEmitter();\n  @Output() onClear = new EventEmitter();\n  @Output() onSave = new EventEmitter();\n\n\n\n\n  showColorPicker: boolean = false;\n\n  //Icons\n  faPencilAlt = faPencilAlt;\n  faSquare = faSquare;\n  faCircle = faCircle;\n  faLongArrowAltRight = faLongArrowAltRight;\n  faFont = faFont;\n  faSquareFull = faSquareFull;\n  faUndo = faUndo;\n  faBan = faBan;\n  faSave = faSave;\n\n  DrawableEnum = DrawableEnum;\n  \n  constructor() { }\n\n  ngOnInit(): void {\n  }\n\n  onDrawableChange(value:DrawableEnum): void {\n    this.drawableTypeChange.emit(value);\n  }\n\n  getClass(value:DrawableEnum): string {\n    var classes = \"toolButton\";\n    if (value === this.drawableType){\n      classes += \" active\";\n    }\n    return classes;\n  }\n\n  showColor(): void {\n    this.showColorPicker = true;\n  }\n\n  onColorChange(event): void {\n    this.colorChange.emit(event.color.hex);\n  }\n\n  onAccept(): void{\n    //setTimeout is hack as onAccept was calling a stale state\n    setTimeout(() => {\n      this.showColorPicker = false;\n    });\n  }\n\n\n  \n  onColorPicked(event): void {\n    this.onColorChange(event);\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { NgAnnoteComponent } from './ng-annote/ng-annote.component';\nimport { ToolbarComponent } from './toolbar/toolbar.component';\nimport { FontAwesomeModule } from '@fortawesome/angular-fontawesome';\nimport { ColorPhotoshopModule } from 'ngx-color/photoshop'\nimport { CommonModule } from '@angular/common';\n\n\n@NgModule({\n  declarations: [\n    NgAnnoteComponent,\n    ToolbarComponent],\n  imports: [\n    FontAwesomeModule,\n    ColorPhotoshopModule,\n    CommonModule\n  ],\n  exports: [NgAnnoteComponent]\n})\nexport class SpproNgAnnoteModule { }\n","/*\n * Public API Surface of sppro-ng-annote\n */\n\nexport * from './lib/ng-annote/ng-annote.component';\nexport * from './lib/sppro-ng-annote.module';\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public-api';\n\nexport {ToolbarComponent as Éµa} from './lib/toolbar/toolbar.component';"],"names":["TEXT_AREA_ID","Konva","EventEmitter","Component","Output","faPencilAlt","faSquare","faCircle","faLongArrowAltRight","faFont","faSquareFull","faUndo","faBan","faSave","Input","NgModule","FontAwesomeModule","ColorPhotoshopModule","CommonModule"],"mappings":"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"}